<!DOCTYPE html>
<!--[if IE 8]>         <html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->

  <head>
     <meta charset="utf-8">
    <title>Video Games Trailers, Previews, News and Videos Your Video games starting page - <%= title %></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="WeArePlaying, videogames, video games, gaming, xbox one, xbox 360, ps4, ps3, iPhone, trailers, previews, announcements, breaking gaming news, hottest video games, best video games, newest video games, indie games, kickstarter games, AAA games, awesome games">
    <meta name="keywords" content="WeArePlaying, videogames, video games, gaming, xbox one, xbox 360, ps4, ps3, iPhone, trailers, previews, announcements, breaking gaming news ">
    <meta name="robots" content="index, follow">
    <link rel="publisher" href="https://plus.google.com/106749096796237814979">

    <link href="/stylesheets/foundation.css" rel="stylesheet">
    <link href="/stylesheets/style.css" rel="stylesheet">
    <link rel="shortcut icon" href="/images/icon.ico" />
    <link href='http://fonts.googleapis.com/css?family=Dosis:400,500,600' rel='stylesheet' type='text/css'>

    <script src="/js/vendor/custom.modernizr.js"></script>


    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/masonry/3.1.2/masonry.pkgd.min.js"></script>
    

    <!-- Popup script 
    <script>
      $(document).ready(function() {
        $('#windowTitleDialog').bind('show', function () {
          document.getElementById ("xlInput").value = document.title;
          });
        });
      function closeDialog () {
        $('#windowTitleDialog').modal('hide'); 
        };
      function okClicked () {
        document.title = document.getElementById ("xlInput").value;
        closeDialog ();
        };
      </script> -->

     
  </head>
  <body style="display:none;" onunload="">
  <div class="row">
    <div class="large-12 columns">
    <!-- Header and Nav -->
      <% include includes/header.ejs %>
      <!-- End of Nav Section-->

    <!-- Page / ranking special -->
    <div class="row">
      <h2 class="bigTitle pageHeader">&nbsp;</h2>
    </div>


    <!-- Content sectiong -->
    <div class="" style="width: 100%;">

    <!-- user account info 


        <div class="content" data-section-content>
          <div class="row">
        
            <div class="large-6 small-12 columns">
              <div class="panel official">
                 <div class="row">
                  <div class="large-12 columns detailDescription" style="max-height: 192px; overflow-y: scroll"><h6><strong>Description</strong></h6><p>something about me</p></div>
                </div>
              </div> 
            </div>

            <div class="large-3 small-6 columns">
              <div class="panel official">
                 <div class="row">
                  <div class="large-12 columns tweets"> 
                    <ul>
                  something about the user
                  </ul>
                  </div>
                </div>
                <div class="row">
                    <div class="large-12 columns author">Genre</div>
                </div>
              </div> 
            </div>
            <div class="large-3 small-6 columns">
              <div class="panel official">
                 <div class="row">
                  <div class="large-12 columns tweets"><h2>some</h2></div>
                </div>
                <div class="row">
                  <div class="large-12 columns author">Friends Tracking This Game</div>
                </div>
              </div> 
            </div>
        </div>
        </div></div>-->
        


    <!-- end of user account info -->


<!-- start of track title listing-->
<div class="darkgray">
      <div class="row">
        <h2 class="bigTitle"><a href="#">YOUR TRACKED GAMES</a></h2>
      </div>


    <!-- start of listing of tweets and events of tracked listings -->
    <div class="row">
    <div class="section-container auto" data-section>

     <% 
          
          for (var i=0; i < data.length; i++){ 
            var panelTitle="panel" + i;

        %>
   <!-- <div class="row"> -->
    <% if (i == 0) { sectionClass = 'active'} else {sectionClass = ''} %>
    <section class="<%= sectionClass %>">
        <div class="title" data-section-title style="width: 95px; word-wrap: break-word;" data-id="<%= data[i]._id %>">
        <!--<div class="rectangle label" style="float:left; position:relative; top:25px; left:6 0px; font-size:1.1em">x</div>-->
          <a href="#<%= panelTitle %>" style="white-space: normal;">
             <!--<div class="itemsmall nohover">
                  <div class="itemsmall-billboard">-->
                    <img src="<%= data[i].get('thumbUrl') %>" style="width:80px; height: 100px;"/><br />
                    <h6><%= data[i].title %></h6><% if (data[i].title.length < 21) { %><br><% } %>
                 <!-- </div>
                  <div class="small-12 columns gametitle" style="padding-top:;"><h6><%= data[i].title %></h6><% if (data[i].title.length < 21) { %><br><% } %></div>
              </div>-->
          </a>
        </div>

        
        <% if (i==0) { %>
        <div class="content" data-section-content id="cardsection">

          <div class="row">
          <div id="masonryContainer">

            <div class="large-3 small-6 columns">
              <div class="panel official">
                <div class="row genre">
                  <div class="large-12 columns tweets"> 
                    <ul>

                      <li>
                        <p><strong>Latest Events</strong></p>
                        <p>a number of events</p>
                      </li>

                    </ul>
                  </div>
                </div>
              </div> 
            </div>

            <%

              function getMonth(data) {
                var MONTH = 0;

                if (data + 1 > 9) {
                  MONTH = data;

                } else {
                  MONTH = "0" + (data+1)
                }

                return MONTH
              }

              function translateDate(data) {
                var date1 = new String(data)
                var MONTHS = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Sep", "Oct", "Nov", "Dec"]
                var dYEAR = date1.slice(11, 15);
                var dMONTH = getMonth(MONTHS.indexOf(date1.slice(4,7)))
                var dDAY = date1.slice(8,10);

                return  new Date(dYEAR, dMONTH, dDAY)

              }

              function days_between(date2) {

                var today = new Date();
                var curDate = today.getDate();
                var curMonth = today.getMonth();
                var curYear = today.getFullYear();


                var launchDate_ms = new Date(translateDate(date2)).getTime();

                var today_ms = new Date(curYear, curMonth, curDate).getTime();

                var timeLeft = Math.round((launchDate_ms - today_ms)/86400000);


                  if (timeLeft == 0){
                      return "Launching Today";
                    } else if (timeLeft < 0) {
                      return "Launched";
                    } else {
                      return timeLeft + " Days Till Launch";
                    }

              }


            %>

            <div class="large-3 small-6 columns">
              <div class="panel official">
                 <div class="row genre">
                  <div class="large-12 columns tweets"> 
                    <ul>
                
                    <li><p><strong>Rank</strong></p>
                      <h2><%= rankings[0].get('recent_rank') %></h2>
                    </li>
                    <li><p>Previous Rank</p>
                      <h3><%= rankings[rankings.length - 1].get('recent_rank') %></h3>
                    </li>
                
                  </ul>
                  </div>
                </div>
              </div> 
            </div>



            <div class="large-6 small-12 columns">
              <div class="panel official">
                 <div class="row">
                  <div class="large-12 columns detailDescription" style="max-height: 192px; overflow-y: scroll">
                    <p style="text-align:center;"><strong>Mentions</strong></p>
                    <canvas id="myChart" width="350" height="160"></canvas>
                  </div>
                </div>
              </div> 
            </div>

            

            

            
          

           <!-- first custom row -->

          
            <% for (var l=0; l < 2; l++){ %>
              <div class="large-3 small-6 columns">
                <div class="panel">
                   <div class="row">
                    <div class="large-12 columns tweets"><%= tweets[l].get('text') %></div>
                  </div>
                  <div class="row">
                    <div class="large-12 columns author"><a href="http://twitter.com/<%= tweets[l].get('author') %>" target="_blank">@<%= tweets[l].get('author') %></a></div>
                  </div>
                   <div class="row">
                    <div class="large-12 columns date"><%= tweets[l].get('created_at') %></div>
                  </div>
                </div> 
              </div>

            <% } %>

            <div class="large-3 small-6 columns">
              <div class="panel official">
                 <div class="row genre">
                  <div class="large-12 columns tweets"> 
                    <ul>
                
                    <li><% if (days_between(data[0].releaseDate) == "Launched") { %><h3 style="padding:0; margin:0;"><%= days_between(data[0].releaseDate) %></h3> <% } else { %> <h3 style="padding:0; margin:0;"><%= days_between(data[0].releaseDate) %></h3> <% } %>
                      <% if (days_between(data[0].releaseDate) != "Launched") { %><p>&nbsp;</p><p><%= data[0].releaseDate %></p><% } %>
                    </li>
                
                  </ul>
                  </div>
                </div>
              </div> 
            </div>

            <% for (var l=2; l < 5; l++){ %>
              <div class="large-3 small-6 columns">
                <div class="panel">
                   <div class="row">
                    <div class="large-12 columns tweets"><%= tweets[l].get('text') %></div>
                  </div>
                  <div class="row">
                    <div class="large-12 columns author">@<%= tweets[l].get('author') %></div>
                  </div>
                   <div class="row">
                    <div class="large-12 columns date"><%= tweets[l].get('created_at') %></div>
                  </div>
                </div> 
              </div>

            <% } %>

            <div class="large-3 small-6 columns">
              <div class="panel official">
                 <div class="row genre">
                  <div class="large-12 columns tweets"> 
                    <ul>
                
                    <li>
                      <a href="/details/<%= rankings[0].get('game') %>" class="medium button transparent" rel="fade">Game Details</a>
                    </li>
                    <li>
                      <a href="/details/untrack/<%= rankings[0].get('game') %>" class="medium button transparent" rel="fade">UnTrack this game.</a>
                    </li>
                
                  </ul>
                  </div>
                </div>
              </div> 
            </div>

            <% for (var l=5; l < tweets.length; l++){ %>
              <div class="large-3 small-6 columns">
                <div class="panel">
                   <div class="row">
                    <div class="large-12 columns tweets"><%= tweets[l].get('text') %></div>
                  </div>
                  <div class="row">
                    <div class="large-12 columns author">@<%= tweets[l].get('author') %></div>
                  </div>
                   <div class="row">
                    <div class="large-12 columns date"><%= tweets[l].get('created_at') %></div>
                  </div>
                  <% 
                  var media = tweets[l].get("media");
                  if (typeof media == "object") {
                  var media_url = "";
                  for (var i=0;i<media.length;i++) {
                    if (media[i].media_url != "") {
                      media_url = media[i].media_url;
                      break;
                    }
                  }


                     if (media_url != "") {
                    %>
                      <div class="row">
                        <div class="large-12 columns date"><img src="<%=media_url%>"></div>
                      </div>
                      <%
                      }}%>


                </div> 
              </div>

            <% } %>
          </div>

        </div>


        </div>
        <% } %>
      </section>
      <% } %>
      </div>
      </div>
    <!--  </div> -->


    

 <!-- footer are -->
    <% include includes/footer.ejs %>
  <!-- end of footer area -->


    <!-- end of listing of tweets -->



    <script>
  document.write('<script src=' +
  ('__proto__' in {} ? '/js/vendor/zepto' : 'js/vendor/jquery') +
  '.js><\/script>')
  </script>
  
  <script src="/js/foundation.min.js"></script>
  <script src="/js/foundation/foundation.section.js"></script>
  <script src="/js/foundation/foundation.topbar.js"></script>
  <script src="/js/Chart.js"></script>

  <!--
  
  <script src="js/foundation/foundation.js"></script>
  
  <script src="js/foundation/foundation.alerts.js"></script>
  
  <script src="js/foundation/foundation.clearing.js"></script>
  
  <script src="js/foundation/foundation.cookie.js"></script>
  
  <script src="js/foundation/foundation.dropdown.js"></script>
  
  <script src="js/foundation/foundation.forms.js"></script>
  
  <script src="js/foundation/foundation.joyride.js"></script>
  
  <script src="js/foundation/foundation.magellan.js"></script>
  
  <script src="js/foundation/foundation.orbit.js"></script>
  
  <script src="js/foundation/foundation.reveal.js"></script>
  
  <script src="js/foundation/foundation.tooltips.js"></script>
  
  <script src="js/foundation/foundation.interchange.js"></script>
  
  <script src="js/foundation/foundation.placeholder.js"></script>
  
  -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-51351-11', 'weareplaying.it');
    ga('send', 'pageview');

  </script>

   <!-- script>
        $('.row[data-match-height]').each(function(){
          var self = $(this);
          self.find('.panel').height(self.height());
          $(window).on('resize', function(event) {
            var row_width = self.width();
            var panels = self.find('.panel');
            // Reset height of the panels
            panels.height('');
            var h = self.height();
            panels.each(function() {
              var panel = $(this);
              if ((row_width - panel.width()) > 40) {
                panel.height(h);
              }
            });
          });
        });

      </script -->
  
  <script>
    $(document).foundation();
  </script>

  <!-- fade out scripts that acts on all rel="fade" -->
   <script src="js/fadescript.js"></script>

   <% 

    var label = [];
    var points = [];

    for (i=0; i<rankings.length; i++)
      {
        label[i] = i;
        points[i] = rankings[i].trendIndex;
      }

    %>

   <script type="text/javascript">

    var graphFloor = Math.max(<%= points %>);
    var graphCeiling = Math.min(<%= points %>);
    var graphStep = Math.floor((graphFloor - graphCeiling) / 4);

    var options = {
      //Boolean - If we want to override with a hard coded scale
      //scaleOverride : true,
      
      //** Required if scaleOverride is true **
      //Number - The number of steps in a hard coded scale
      //scaleSteps : graphStep,
      //Number - The value jump in the hard coded scale
      //scaleStepWidth : -1,
      //Number - The scale starting value
      //scaleStartValue : graphCeiling,
      //Boolean - If we show the scale above the chart data     
      scaleOverlay : true,
      //Number - Pixel width of dataset stroke
      datasetStrokeWidth : 10,

      //String - Scale label font colour  
      scaleFontColor : "#888",  

      //Number - Scale label font size in pixels  
      scaleFontSize : 10,
      
      ///Boolean - Whether grid lines are shown across the chart
      scaleShowGridLines : false,


    };
    var data = {
      labels : [<%= label %>],
      datasets : [
        {
          fillColor : "#87cefa",
          strokeColor : "#333333",
          pointColor : "#FFFFFF",
          pointStrokeColor : "#333333",
          data : [<%= points %>]
        },
      ]
    } 

    var ctx = document.getElementById("myChart").getContext("2d");
    var myNewChart = new Chart(ctx).Line(data, options);

    $(function(){
      var $container = $('#masonryContainer').masonry();
        $container.masonry({  
          itemSelector: '.columns'
          , columnWidth: '.large-3'
        });
    });    
    </script>

   </script>

  </body>
</html>
